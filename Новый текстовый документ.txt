1) Дано: VBA-процедура, которая ищет и выводит все значения из таблицы entity_attributes_xref, соответствующие условию: entityID=25 и value_txt содержит «неверное значение атрибута»

Private Sub subTest1()
Dim rs1 As Recordset, s1 As String
s1 = "SELECT id_entity_attributes, entityID FROM entity_attributes_xref WHERE value_txt Like '*неверное значение атрибута*'"
Set rs1 = CurrentDb.OpenRecordset(s1, dbOpenSnapshot)
    Do While rs1.EOF = False
        If rs1.Fields("entityID") = 25 Then
            Debug.Print rs1.Fields("id_entity_attributes")
        End If
    Loop
rs1.Close: Set rs1 = Nothing
End Sub

1.1) Вопрос: почему цикл ищет не все записи, варианты правки кода для поиска всех записей соотв. условиям поиска указанным в п.1
1.2) Задание: ваш вариант оптимизации этого кода


2) Дано: Таблица users (много тысяч записей) пользователей и их кладров. Первые 6 записей:
id kladr_full city_name
76089 770000000000000 Москва
75982 520000010000000 Нижний Новгород
76136 480000010000000 Липецк г.
75225 520000070000000 Выкса г.
75974 520270010000000 Кстово г.
76121 700000010000000 Томск г.
...

Задание: Написать VBA-функцию, которая возвращает в debug id пользователей из нижегородского региона

===================================
Не стесняйтесь, если возникнут вопросы.
По результатам выполнения задания назначается собеседование.
Большинство программ выполняется в среде MS Access 2003
С уважением, Сергей